# P10 é¡µé¢ - Lenovoæ³•å›½å¸‚åœºæƒ…æ„Ÿåˆ†æ

## é¡¹ç›®æ¦‚è¿°

P10é¡µé¢ä¸“é—¨ç”¨äºåˆ†æLenovoå“ç‰Œåœ¨æ³•å›½å¸‚åœºçš„æƒ…æ„Ÿè¡¨ç°ï¼Œé€šè¿‡é¥¼å›¾å’ŒæŠ˜çº¿å›¾å±•ç¤º2025å¹´8æœˆ7æ—¥è‡³28æ—¥æœŸé—´çš„æƒ…æ„Ÿåˆ†å¸ƒå’Œè¶‹åŠ¿å˜åŒ–ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ“Š æ•°æ®å¯è§†åŒ–
- **é¥¼å›¾**: å±•ç¤ºæ•´ä½“æƒ…æ„Ÿåˆ†å¸ƒï¼ˆç§¯æã€ä¸­æ€§ã€æ¶ˆæï¼‰
- **æŠ˜çº¿å›¾**: å±•ç¤ºæ¯æ—¥æƒ…æ„Ÿè¶‹åŠ¿å˜åŒ–

### ğŸ¯ æ•°æ®æ¥æº
- **æ•°æ®åº“**: neticle-v5-08.sqlite
- **æ•°æ®è¡¨**: mentions_wide
- **å…³é”®å­—æ®µ**: 
  - `polarity`: æƒ…æ„Ÿææ€§å€¼
  - `createdAtUtcMs`: æ—¶é—´æˆ³
  - `countryIsoCode2`: å›½å®¶ä»£ç 
  - `keyword_label`: å…³é”®è¯æ ‡ç­¾

### ğŸ¨ é¢œè‰²é…ç½®
- **ç»Ÿä¸€é¢œè‰²æ–¹æ¡ˆ**: ç¡®ä¿æ‰€æœ‰å›¾è¡¨å…ƒç´ é¢œè‰²ä¸€è‡´æ€§
- **æƒ…æ„Ÿé¢œè‰²æ˜ å°„**:
  - Positiveï¼ˆç§¯æï¼‰: `#009FA9` (è“ç»¿è‰²ï¼Œæ¨¡æ¿)
  - Neutralï¼ˆä¸­æ€§ï¼‰: `#FFBC42` (ç¥ç€é»„ï¼Œæ¨¡æ¿)
  - Negativeï¼ˆæ¶ˆæï¼‰: `#D81159` (æ´‹çº¢çº¢ï¼Œæ¨¡æ¿)
- **åº”ç”¨èŒƒå›´**: é¥¼å›¾å¡«å……ã€æŠ˜çº¿å›¾çº¿æ¡ã€å›¾ä¾‹æ ‡è¯†

### ğŸ” ç­›é€‰æ¡ä»¶
- **åœ°åŒº**: æ³•å›½ (`countryIsoCode2='fr'`)
- **å“ç‰Œ**: Lenovo (`keyword_label LIKE '%lenovo%'`)
- **æ—¶é—´èŒƒå›´**: 2025å¹´8æœˆ7æ—¥-28æ—¥

### ğŸ“Š æƒ…æ„Ÿåˆ†ç±»è§„åˆ™
- **Positiveï¼ˆç§¯æï¼‰**: polarity > 10
- **Neutralï¼ˆä¸­æ€§ï¼‰**: 0 â‰¤ polarity â‰¤ 10
- **Negativeï¼ˆæ¶ˆæï¼‰**: polarity < 0

## é¡¹ç›®ç»“æ„

```
p10/
â”œâ”€â”€ build.py              # ä¸»æ„å»ºè„šæœ¬ï¼ˆä¸€é”®æ‰§è¡Œï¼‰
â”œâ”€â”€ generate_excel.py     # æ•°æ®æå–å’ŒExcelç”Ÿæˆ
â”œâ”€â”€ fill_from_excel.py    # PPTæ¨¡æ¿å¡«å……ï¼ˆåŒ…å«é¢œè‰²é…ç½®ï¼‰
â”œâ”€â”€ config.yaml          # é¡µé¢çº§é…ç½®æ–‡ä»¶
â”œâ”€â”€ éœ€æ±‚.md              # è¯¦ç»†éœ€æ±‚æ–‡æ¡£
â”œâ”€â”€ p10-å›¾è¡¨è§£é‡Š.md      # å›¾è¡¨è¯¦ç»†è§£é‡Šæ–‡æ¡£
â”œâ”€â”€ readme.md            # æœ¬æ–‡æ¡£
â”œâ”€â”€ p10_data.xlsx        # ç”Ÿæˆçš„Excelæ•°æ®æ–‡ä»¶
â”œâ”€â”€ logs/                # æ—¥å¿—ç›®å½•
â”‚   â””â”€â”€ build.log        # æ„å»ºæ—¥å¿—
â””â”€â”€ output/              # è¾“å‡ºç›®å½•
    â””â”€â”€ p10-final.pptx   # æœ€ç»ˆç”Ÿæˆçš„PPTæ–‡ä»¶
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

ç¡®ä¿å·²å®‰è£…ä»¥ä¸‹PythonåŒ…ï¼š
```bash
pip install pandas openpyxl pyyaml lxml
```

### 2. ä¸€é”®æ„å»º

```bash
cd charts/p10
python build.py
```

### 3. åˆ†æ­¥æ‰§è¡Œï¼ˆå¯é€‰ï¼‰

å¦‚éœ€åˆ†æ­¥æ‰§è¡Œï¼Œå¯ä»¥å•ç‹¬è¿è¡Œï¼š

```bash
# 1. ç”ŸæˆExcelæ•°æ®
python generate_excel.py

# 2. å¡«å……PPTæ¨¡æ¿
python fill_from_excel.py
```

## é…ç½®è¯´æ˜

### ä¸»è¦é…ç½®é¡¹

- **æ•°æ®æºè·¯å¾„**: `data_sources.neticle`
- **æ—¶é—´èŒƒå›´**: `time_range.start_date` / `end_date`
- **ç­›é€‰æ¡ä»¶**: `filters.country` / `brand`
- **æƒ…æ„Ÿåˆ†ç±»**: `sentiment_analysis.polarity_conditions`
- **å›¾è¡¨è®¾ç½®**: `charts.pie` / `line`

### æƒ…æ„Ÿåˆ†ç±»è§„åˆ™

```yaml
sentiment_analysis:
  polarity_conditions:
    positive: "> 10"      # ç§¯ææƒ…æ„Ÿ
    neutral: "0 to 10"    # ä¸­æ€§æƒ…æ„Ÿ  
    negative: "< 0"       # æ¶ˆææƒ…æ„Ÿ
```

### é¢œè‰²é…ç½®

é»˜è®¤é¢œè‰²ç­–ç•¥ä¸ºâ€œä¿ç•™æ¨¡æ¿é¢œè‰²â€ï¼ˆä¸è¦†ç›–æ¨¡æ¿ä¸­ç³»åˆ—é¢œè‰²ï¼‰ï¼Œä»…æ›´æ–°æ•°æ®ã€‚è‹¥éœ€å¼ºåˆ¶ä½¿ç”¨é…ç½®é¢œè‰²ï¼Œå¯å¼€å¯å¼€å…³ `fill_policy.use_config_colors=true`ã€‚é…ç½®é¢œè‰²åœ¨ `charts.pie_chart.colors` ä¸‹å£°æ˜ï¼ŒæŠ˜çº¿/æ•£ç‚¹ç³»åˆ—æŒ‰ Positive/Neutral/Negative çš„é¡ºåºå¤ç”¨ç›¸åŒé¢œè‰²ã€‚

```yaml
charts:
  pie_chart:
    colors:
      positive: "#009FA9"     # è“ç»¿è‰²ï¼ˆæ¨¡æ¿ï¼‰- ç§¯ææƒ…æ„Ÿ
      neutral: "#FFBC42"      # ç¥ç€é»„ï¼ˆæ¨¡æ¿ï¼‰- ä¸­æ€§æƒ…æ„Ÿ
      negative: "#D81159"     # æ´‹çº¢çº¢ï¼ˆæ¨¡æ¿ï¼‰- æ¶ˆææƒ…æ„Ÿ
  line_chart:
    lines: ["Positive", "Neutral", "Negative"]  # ç³»åˆ—é¡ºåºä¸é¢œè‰²ä¸€è‡´

fill_policy:
  use_config_colors: false      # é»˜è®¤ä¿ç•™æ¨¡æ¿é¢œè‰²ï¼›è®¾ä¸ºtrueåˆ™å¼ºåˆ¶ä½¿ç”¨ä¸Šè¿°é…ç½®é¢œè‰²
```

è¯´æ˜ï¼š
- è‹¥æ¨¡æ¿ç¼ºå°‘å¯¹åº”é¢œè‰²èŠ‚ç‚¹ï¼ˆå¦‚ `a:ln/a:solidFill/a:srgbClr`ï¼‰ï¼Œè„šæœ¬å°†æŠ¥é”™ï¼Œä¸åšå…œåº•å¤„ç†ã€‚
- å½“ `use_config_colors=false` æ—¶ï¼Œè„šæœ¬ä¸ä¼šå†™å…¥é¢œè‰²èŠ‚ç‚¹ï¼Œå®Œå…¨ä¿ç•™æ¨¡æ¿åŸæœ‰ç³»åˆ—é¢œè‰²ï¼›å½“ `true` æ—¶ï¼Œä¸¥æ ¼æŒ‰é…ç½®è¦†ç›–åˆ°é¥¼å›¾/æŠ˜çº¿/æ•£ç‚¹ç³»åˆ—ã€‚

## è¾“å‡ºæ–‡ä»¶

### Excelæ–‡ä»¶ (`p10_data.xlsx`)
- **Sheet1 - é¥¼å›¾æ•°æ®**: æƒ…æ„Ÿåˆ†ç±»ç»Ÿè®¡
- **Sheet2 - æŠ˜çº¿å›¾æ•°æ®**: æ¯æ—¥æƒ…æ„Ÿè¶‹åŠ¿
- **Sheet3 - å…ƒæ•°æ®**: æ•°æ®è´¨é‡å’Œç»Ÿè®¡ä¿¡æ¯

### PPTæ–‡ä»¶ (`output/p10-final.pptx`)
- åŸºäºæ¨¡æ¿ç”Ÿæˆçš„æœ€ç»ˆæ¼”ç¤ºæ–‡ç¨¿
- åŒ…å«åµŒå…¥çš„Excelæ•°æ®å’Œå›¾è¡¨

## æ•°æ®è´¨é‡æ§åˆ¶

### è‡ªåŠ¨æ£€æŸ¥é¡¹
- âœ… æ•°æ®å®Œæ•´æ€§éªŒè¯
- âœ… æ—¶é—´èŒƒå›´æ ¡éªŒ
- âœ… æƒ…æ„Ÿåˆ†ç±»å‡†ç¡®æ€§
- âœ… é¢œè‰²é…ç½®ä¸€è‡´æ€§éªŒè¯
- âœ… è¾“å‡ºæ–‡ä»¶å¤§å°æ£€æŸ¥

### è´¨é‡æŒ‡æ ‡
- **æ•°æ®è¦†ç›–ç‡**: ç¡®ä¿æ¯æ—¥éƒ½æœ‰æ•°æ®
- **æƒ…æ„Ÿåˆ†å¸ƒ**: éªŒè¯ä¸‰ç±»æƒ…æ„Ÿéƒ½æœ‰æ•°æ®
- **å¼‚å¸¸å€¼æ£€æµ‹**: è¯†åˆ«æç«¯polarityå€¼

## æ—¥å¿—å’Œè°ƒè¯•

### æ—¥å¿—æ–‡ä»¶
- **ä½ç½®**: `logs/build.log`
- **çº§åˆ«**: INFOï¼ˆå¯åœ¨config.yamlä¸­è°ƒæ•´ï¼‰
- **å†…å®¹**: å®Œæ•´çš„æ‰§è¡Œè¿‡ç¨‹å’Œé”™è¯¯ä¿¡æ¯

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤æ–‡ä»¶æƒé™

2. **Excelç”Ÿæˆå¤±è´¥**
   - æ£€æŸ¥ç£ç›˜ç©ºé—´
   - ç¡®è®¤openpyxlåº“å·²å®‰è£…

3. **PPTå¡«å……å¤±è´¥**
   - æ£€æŸ¥æ¨¡æ¿æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   - ç¡®è®¤lxmlåº“å·²å®‰è£…
   - éªŒè¯é¢œè‰²é…ç½®æ ¼å¼æ­£ç¡®æ€§

## æ€§èƒ½æŒ‡æ ‡

- **æ•°æ®æå–**: ~0.5ç§’ï¼ˆ5557æ¡è®°å½•ï¼‰
- **Excelç”Ÿæˆ**: ~0.2ç§’
- **PPTå¡«å……**: ~0.3ç§’
- **æ€»è€—æ—¶**: <1ç§’

## ç‰ˆæœ¬ä¿¡æ¯

- **åˆ›å»ºæ—¥æœŸ**: 2024-11-01
- **ç‰ˆæœ¬**: 1.0.0
- **Pythonè¦æ±‚**: 3.7+
- **ä¾èµ–åº“**: pandas, openpyxl, pyyaml, lxml

## ç»´æŠ¤è¯´æ˜

### å®šæœŸæ£€æŸ¥
- æ•°æ®åº“æ–‡ä»¶æ›´æ–°
- é…ç½®å‚æ•°è°ƒæ•´
- æ¨¡æ¿æ–‡ä»¶ç»´æŠ¤

### æ‰©å±•å»ºè®®
- æ”¯æŒæ›´å¤šæ—¶é—´èŒƒå›´
- å¢åŠ å…¶ä»–å“ç‰Œåˆ†æ
- æ·»åŠ æ›´å¤šå¯è§†åŒ–å›¾è¡¨
- æ”¯æŒè‡ªå®šä¹‰é¢œè‰²ä¸»é¢˜
- å¢åŠ äº¤äº’å¼å›¾è¡¨åŠŸèƒ½

---

**æ³¨æ„**: æœ¬é¡µé¢éµå¾ªMVPåŸåˆ™ï¼Œä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½å®ç°ï¼Œé¿å…è¿‡åº¦è®¾è®¡ã€‚å¦‚éœ€æ‰©å±•åŠŸèƒ½ï¼Œè¯·å‚è€ƒéœ€æ±‚æ–‡æ¡£è¿›è¡Œè§„åˆ’ã€‚

## æ•°æ®æºä¸å­—æ®µ

æ ¸å¿ƒæ¥è‡ª metrics_v5 èšåˆåº“ï¼š
1. `brand_metrics_month`ï¼ˆæœˆåº¦ï¼‰ï¼š`positive_mentions`ã€`neutral_mentions`ã€`negative_mentions`
2. `brand_metrics_day`ï¼ˆæ—¥åº¦ï¼‰ï¼š`positive_mentions`ã€`neutral_mentions`ã€`negative_mentions`

è¿‡æ»¤æ¡ä»¶ï¼ˆæ¥è‡ª `gen_ppt/config.yaml` çš„ filters é…ç½®ï¼‰ï¼š
- `countryId`ï¼šç›®æ ‡å›½å®¶ï¼ˆç¤ºä¾‹ 39=Franceï¼‰
- `brand_key`ï¼šç›®æ ‡å“ç‰Œï¼ˆç¤ºä¾‹ Lenovoï¼‰ã€‚å†…éƒ¨ä»¥ `LOWER(brand)=lower(brand_key)` åŒ¹é…
- æ—¶é—´èŒƒå›´ï¼š`update.start_date` ~ `update.end_date`

è¯´æ˜ï¼šæ—©æœŸæ–‡æ¡£çš„ SOV ä¸â€œLenovo vs Othersâ€å®ç°å·²æ›¿æ¢ä¸ºâ€œä¸‰åˆ†ç±»æƒ…æ„Ÿâ€å®ç°ï¼›æ¶‰åŠçš„å­—æ®µåˆ‡æ¢ä¸ºæ­£ä¸­è´Ÿä¸‰åˆ—ã€‚

## è®¡ç®—ä¸æ˜ å°„

- chart8ï¼ˆé¥¼å›¾ï¼‰ï¼š
  - åˆ†æ¯ `denom = pos + neu + neg`ï¼›å„ç±»å€¼é™¤ä»¥ `denom` åä¹˜ 100ï¼Œä¿ç•™ 1 ä½å°æ•°ã€‚
- chart9ï¼ˆæŠ˜çº¿ï¼‰ï¼š
  - é»˜è®¤â€œæ¯æ—¥å æ¯”â€ï¼šå¯¹ `brand_metrics_day` æ¯å¤©è®¡ç®—
    - `p_t = positive_mentions(t)`ï¼Œ`n_t = neutral_mentions(t)`ï¼Œ`ng_t = negative_mentions(t)`
    - `denom_t = p_t + n_t + ng_t`
    - `pos%_t = 100 * p_t / denom_t`ï¼ˆ`denom_t=0` æ—¶è®° 0ï¼‰ï¼Œ`neu%_t`ã€`neg%_t` åŒç†ï¼›ä¿ç•™ 1 ä½å°æ•°ã€‚
  - å¯é€‰â€œå¹³æ»‘å æ¯”ï¼ˆæ»‘çª—ï¼‰â€ï¼šåœ¨ `charts/p10/config.yaml` å¯ç”¨
    - `chart9.smooth_percent: true`
    - `chart9.smooth_window: 7`ï¼ˆå¤©ï¼‰
    - è®¡ç®—æ–¹å¼ä¸ºâ€œçª—å£æ»šåŠ¨æ±‚å’Œåå†æ±‚å æ¯”â€ï¼š
      - `P_t = sum_{i=t-w+1..t} p_i`ï¼ˆçª—å£å¤–è§†ä¸º 0ï¼Œ`min_periods=1`ï¼‰
      - `N_tã€NG_t` åŒç†ï¼Œ`DEN_t = P_t + N_t + NG_t`
      - `pos%_t = 100 * P_t / DEN_t`ï¼ˆ`DEN_t=0` æ—¶è®° 0ï¼‰ï¼Œå…¶ä½™åŒç†ï¼›ä¿ç•™ 1 ä½å°æ•°ã€‚
- x è½´ä¸ºè¿ç»­æ•°å€¼ï¼š`axis_day_base + åºå·`ï¼ˆæ¥è‡ª `fill_policy.axis_day_base`ï¼‰ã€‚è¯¥æ•°å€¼ä¼šå†™å…¥åµŒå…¥å·¥ä½œç°¿ `LineData` çš„é¦–åˆ— `X`ï¼Œå¹¶ä½œä¸ºæ•£ç‚¹å›¾ `xVal` çš„æ•°æ®æ¥æºï¼›`yVal` åˆ†åˆ«ç»‘å®šåˆ° `Positive`ã€`Neutral`ã€`Negative` åˆ—ã€‚

## ç¼ºå¤±æ•°æ®å…œåº•

- ä»»ä¸€æ•°æ®æºç¼ºå¤±æˆ–åˆ†æ¯ä¸º 0 æ—¶ï¼Œé€€å›ä½¿ç”¨ `original_*` ç¼“å­˜ï¼ˆ`chart8/original_series.json`ã€`chart9/original_scatter.json`ï¼‰ã€‚
- äº§å‡º `data.json` ä¸ `final_data.json`ï¼Œå¡«å……è„šæœ¬ä¼˜å…ˆè¯»å– `final_data.json`ã€‚

## äº§å‡º JSON ç»“æ„

- chart8ï¼š`{ "labels": ["Positive","Neutral","Negative"], "series": [ {"name": null, "values": [..] } ] }`
- chart9ï¼š`{ "scatter_series": [ {"name":"Positive","x":[..],"y":[..]}, {"name":"Neutral",..}, {"name":"Negative",..} ] }`

## é…ç½®é¡¹ï¼ˆp10/config.yamlï¼‰

```
output:
  replace_charts: ["chart8.xml","chart9.xml"]
  final_mode: updated
fill_policy:
  axis_day_base: 20300
chart9:
  smooth_percent: false   # æ˜¯å¦å¯ç”¨ 7 æ—¥ï¼ˆå¯è°ƒï¼‰æ»‘çª—çš„â€œå¹³æ»‘å æ¯”â€
  smooth_window: 7        # çª—å£å¤§å°ï¼ˆå¤©ï¼‰ï¼Œä»…åœ¨ smooth_percent=true æ—¶ç”Ÿæ•ˆ
```

## æ„å»ºä¸é¢„è§ˆ

æ¨èä¸€æ¬¡æ€§æ„å»ºå¹¶ç”Ÿæˆé¢„è§ˆï¼š

```
python gen_ppt/charts/p10/build_all.py --mode both
```

å®ƒå°†æ‰§è¡Œï¼š
- è¿è¡Œ `make_data.py` ç”Ÿæˆæ•°æ® JSON
- è°ƒç”¨ `chart8/fill.py`ã€`chart9/fill.py` æ›´æ–°æ¨¡æ¿ XML
- ç”Ÿæˆ `output/p10.pptx`ï¼ˆå•é¡µç‰ˆï¼‰ä¸ `output/LRTBH-final-*.pptx` åˆå¹¶ç¨¿ï¼ˆå–å†³äºå…¨å±€é…ç½®ï¼‰
- åŸºäº `original_*` ç”Ÿæˆ `preview_original.png` ä¾¿æ·å¯¹æ¯”å›¾

## å¯¹é½ä¸æ ¡éªŒ

- å­—æ®µå¯¹é½ï¼šä¸‰åˆ†ç±»å­—æ®µåœ¨ `brand_metrics_day/month` ä¸­å‘½åä¸º `positive_mentions`ã€`neutral_mentions`ã€`negative_mentions`ã€‚
- éªŒè¯ï¼š`gen_ppt/tools/build_all.py` ä¼šå¯¹æ›¿æ¢çš„ chart xml åšç®€æ˜“å˜æ›´æ£€æµ‹ï¼Œä¾¿äºå‘ç°æœªç”Ÿæ•ˆçš„æ›¿æ¢ã€‚
